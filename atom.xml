<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>goubo blogs</title>
  
  <subtitle>记录学习</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-10-14T07:51:50.761Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>goubo</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>RNA_seq_WYH</title>
    <link href="http://yoursite.com/2019/10/29/RNA_seq_WYH/"/>
    <id>http://yoursite.com/2019/10/29/RNA_seq_WYH/</id>
    <published>2019-10-29T03:31:34.593Z</published>
    <updated>2019-10-14T07:51:50.761Z</updated>
    
    <content type="html"><![CDATA[<h1 id="RNA-seq-WYH"><a href="#RNA-seq-WYH" class="headerlink" title="RNA_seq_WYH"></a>RNA_seq_WYH</h1><blockquote><p>2019-10-13</p><p>goubo</p></blockquote><h2 id="1准备"><a href="#1准备" class="headerlink" title="1准备"></a>1准备</h2><h3 id="数据介绍"><a href="#数据介绍" class="headerlink" title="数据介绍"></a>数据介绍</h3><p>Spermophilus dauricus </p><h3 id="参考基因组下载"><a href="#参考基因组下载" class="headerlink" title="参考基因组下载"></a>参考基因组下载</h3><blockquote><p><a href="[ftp://ftp.ensembl.org/pub/release-98/gtf/spermophilus_dauricus](ftp://ftp.ensembl.org/pub/release-98/gtf/spermophilus_dauricus)">ensemble</a></p><p><a href="ftp://ftp.ensembl.org/pub/release-98/fasta/spermophilus_dauricus/dna/Spermophilus_dauricus.ASM240643v1.dna_sm.toplevel.fa.gz" target="_blank" rel="noopener">选择</a></p><p>解压缩</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -d Spermophilus_dauricus.ASM240643v1.dna_sm.toplevel.fa.gz</span><br></pre></td></tr></table></figure></blockquote><h3 id="注释文件下载"><a href="#注释文件下载" class="headerlink" title="注释文件下载"></a>注释文件下载</h3><blockquote><p><a href="[ftp://ftp.ensembl.org/pub/release-98/fasta/spermophilus_dauricus/dna/](ftp://ftp.ensembl.org/pub/release-98/fasta/spermophilus_dauricus/dna/)">ensemble</a></p><p><a href="ftp://ftp.ensembl.org/pub/release-98/gtf/spermophilus_dauricus/Spermophilus_dauricus.ASM240643v1.98.gtf.gz" target="_blank" rel="noopener">选择</a></p><p>解压</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -d Spermophilus_dauricus.ASM240643v1.98.gtf.gz</span><br></pre></td></tr></table></figure></blockquote><h2 id="2-Fastqc"><a href="#2-Fastqc" class="headerlink" title="2 Fastqc"></a>2 Fastqc</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for i in *fastq.gz; do nohup fastqc $&#123;i&#125; &amp; done</span><br><span class="line">整合结果</span><br><span class="line">mv *html *.zip ./qcreport/</span><br><span class="line">(RNApython3.4) goubo@nucleusa:~/rna-seq_wyh/samples/qcreport$ multiqc ./*zip</span><br></pre></td></tr></table></figure><h2 id="3-构建index"><a href="#3-构建index" class="headerlink" title="3 构建index"></a>3 构建index</h2><h3 id="激活环境"><a href="#激活环境" class="headerlink" title="激活环境"></a>激活环境</h3><figure class="highlight plain"><figcaption><span>conda activate RNApython3.4</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ conda activate RNApython3.4</span><br></pre></td></tr></table></figure><h3 id="extract-splice-site-and-exon-information-from-the-gene-annotation-file"><a href="#extract-splice-site-and-exon-information-from-the-gene-annotation-file" class="headerlink" title="extract splice-site and exon information from the gene annotation file"></a>extract splice-site and exon information from the gene annotation file</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(RNApython3.4) goubo@nucleusa:~/rna-seq_wyh/indexes$ extract_splice_sites.py  ../genes/Spermophilus_dauricus.ASM240643v1.98.gtf &gt;index.ss &amp;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(RNApython3.4) goubo@nucleusa:~/rna-seq_wyh/indexes$ extract_exons.py ../genes/Spermophilus_dauricus.ASM240643v1.98.gtf &gt;index.exon &amp;</span><br></pre></td></tr></table></figure><h3 id="build-a-HISAT2-index"><a href="#build-a-HISAT2-index" class="headerlink" title="build a HISAT2 index"></a>build a HISAT2 index</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(RNApython3.4) goubo@nucleusa:~/rna-seq_wyh/indexes$ nohup hisat2-build -p 3 --ss index.ss --exon index.exon ../genome/Spermophilus_dauricus.ASM240643v1.dna_sm.toplevel.fa index_tran &amp;</span><br></pre></td></tr></table></figure><h2 id="4Align-the-rna-seq-reads-to-the-genome"><a href="#4Align-the-rna-seq-reads-to-the-genome" class="headerlink" title="4Align the rna-seq reads to the genome"></a>4Align the rna-seq reads to the genome</h2><h3 id="Map-the-reads-for-each-sample-to-the-reference-genome"><a href="#Map-the-reads-for-each-sample-to-the-reference-genome" class="headerlink" title="Map the reads for each sample to the reference genome"></a>Map the reads for each sample to the reference genome</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(RNApython3.4) goubo@nucleusa:~/rna-seq_wyh/samples$ for i in *1.fastq.gz; do i=$&#123;i%1.fastq.gz*&#125;; nohup hisat2 -p 3 --dta -x ~/rna-seq_wyh/indexes/index_tran -1 $&#123;i&#125;1.fastq.gz -2 $&#123;i&#125;2.fastq.gz -S $&#123;i&#125;align.sam 2&gt;~/rna-seq_wyh/$&#123;i&#125;align.log &amp; done</span><br></pre></td></tr></table></figure><p>比对结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(base) goubo@nucleusa:~/rna-seq_wyh$ cat WGC086227-4yueyangping_combined_Ralign.log</span><br><span class="line">nohup: ignoring input and appending output to &apos;nohup.out&apos;</span><br><span class="line">32359959 reads; of these:</span><br><span class="line">  32359959 (100.00%) were paired; of these:</span><br><span class="line">    7647775 (23.63%) aligned concordantly 0 times</span><br><span class="line">    18792185 (58.07%) aligned concordantly exactly 1 time</span><br><span class="line">    5919999 (18.29%) aligned concordantly &gt;1 times</span><br><span class="line">    ----</span><br><span class="line">    7647775 pairs aligned concordantly 0 times; of these:</span><br><span class="line">      185683 (2.43%) aligned discordantly 1 time</span><br><span class="line">    ----</span><br><span class="line">    7462092 pairs aligned 0 times concordantly or discordantly; of these:</span><br><span class="line">      14924184 mates make up the pairs; of these:</span><br><span class="line">        9775642 (65.50%) aligned 0 times</span><br><span class="line">        3913777 (26.22%) aligned exactly 1 time</span><br><span class="line">        1234765 (8.27%) aligned &gt;1 times</span><br><span class="line">84.90% overall alignment rate</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(base) goubo@nucleusa:~/rna-seq_wyh$ cat WGC086227-6yueyangping_combined_Ralign.log</span><br><span class="line">nohup: ignoring input and appending output to &apos;nohup.out&apos;</span><br><span class="line">44075165 reads; of these:</span><br><span class="line">  44075165 (100.00%) were paired; of these:</span><br><span class="line">    10625305 (24.11%) aligned concordantly 0 times</span><br><span class="line">    25406685 (57.64%) aligned concordantly exactly 1 time</span><br><span class="line">    8043175 (18.25%) aligned concordantly &gt;1 times</span><br><span class="line">    ----</span><br><span class="line">    10625305 pairs aligned concordantly 0 times; of these:</span><br><span class="line">      254958 (2.40%) aligned discordantly 1 time</span><br><span class="line">    ----</span><br><span class="line">    10370347 pairs aligned 0 times concordantly or discordantly; of these:</span><br><span class="line">      20740694 mates make up the pairs; of these:</span><br><span class="line">        13553945 (65.35%) aligned 0 times</span><br><span class="line">        5459848 (26.32%) aligned exactly 1 time</span><br><span class="line">        1726901 (8.33%) aligned &gt;1 times</span><br><span class="line">84.62% overall alignment rate</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(base) goubo@nucleusa:~/rna-seq_wyh$ cat WGC086227-6yueyangping_combined_Ralign.log</span><br><span class="line">nohup: ignoring input and appending output to &apos;nohup.out&apos;</span><br><span class="line">44075165 reads; of these:</span><br><span class="line">  44075165 (100.00%) were paired; of these:</span><br><span class="line">    10625305 (24.11%) aligned concordantly 0 times</span><br><span class="line">    25406685 (57.64%) aligned concordantly exactly 1 time</span><br><span class="line">    8043175 (18.25%) aligned concordantly &gt;1 times</span><br><span class="line">    ----</span><br><span class="line">    10625305 pairs aligned concordantly 0 times; of these:</span><br><span class="line">      254958 (2.40%) aligned discordantly 1 time</span><br><span class="line">    ----</span><br><span class="line">    10370347 pairs aligned 0 times concordantly or discordantly; of these:</span><br><span class="line">      20740694 mates make up the pairs; of these:</span><br><span class="line">        13553945 (65.35%) aligned 0 times</span><br><span class="line">        5459848 (26.32%) aligned exactly 1 time</span><br><span class="line">        1726901 (8.33%) aligned &gt;1 times</span><br><span class="line">84.62% overall alignment rate</span><br></pre></td></tr></table></figure><h3 id="Sort-and-convert-the-SAM-files-to-BAM"><a href="#Sort-and-convert-the-SAM-files-to-BAM" class="headerlink" title="Sort and convert the SAM files to BAM"></a>Sort and convert the SAM files to BAM</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for i in *.sam; do i=$&#123;i%align.sam*&#125;; nohup samtools sort -@ 3 -o $&#123;i&#125;.bam $&#123;i&#125;align.sam &amp;  done</span><br></pre></td></tr></table></figure><h2 id="5Assemble-and-quantify-expressed-genes-and-transcripts"><a href="#5Assemble-and-quantify-expressed-genes-and-transcripts" class="headerlink" title="5Assemble and quantify expressed genes and transcripts"></a>5Assemble and quantify expressed genes and transcripts</h2><h3 id="Assemble-transcripts-for-each-sample"><a href="#Assemble-transcripts-for-each-sample" class="headerlink" title="Assemble transcripts for each sample"></a>Assemble transcripts for each sample</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(RNApython3.4) goubo@nucleusa:~/rna-seq_wyh/samples$ for i in *.bam;do i=$&#123;i%.bam*&#125;; nohup stringtie -             p 3 -G ~/rna-seq_wyh/genes/Spermophilus_dauricus.ASM240643v1.98.gtf -o $&#123;i&#125;.gtf $&#123;i&#125;.bam &amp; done</span><br></pre></td></tr></table></figure><h3 id="Merge-transcripts-from-all-samples"><a href="#Merge-transcripts-from-all-samples" class="headerlink" title="Merge transcripts from all samples"></a>Merge transcripts from all samples</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">编辑merge.list</span><br><span class="line"></span><br><span class="line">(RNApython3.4) goubo@nucleusa:~/rna-seq_wyh/samples$ stringtie --merge -p 3 -G ~/rna-seq_wyh/genes/Spermophilus_dauricus.ASM240643v1.98.gtf -o stringtie_merged.gtf ./mergelist.txt &amp;</span><br></pre></td></tr></table></figure><h3 id="Examine-how-the-transcripts-compare-with-the-reference-annotation-optional"><a href="#Examine-how-the-transcripts-compare-with-the-reference-annotation-optional" class="headerlink" title="Examine how the transcripts compare with the reference annotation (optional)"></a>Examine how the transcripts compare with the reference annotation (optional)</h3><h3 id="Estimate-transcript-abundances-and-create-table-counts-for-Ballgown"><a href="#Estimate-transcript-abundances-and-create-table-counts-for-Ballgown" class="headerlink" title="Estimate transcript abundances and create table counts for Ballgown"></a>Estimate transcript abundances and create table counts for Ballgown</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(RNApython3.4) goubo@nucleusa:~/rna-seq_wyh/samples$ for i in *.bam; do i=$&#123;i%.bam*&#125;; nohup stringtie -e -B -p 3 -G stringtie_merged.gtf -o ~/rna-seq_wyh/ballgown/$&#123;i&#125;/$&#123;i&#125;_.gtf $&#123;i&#125;.bam &amp; done</span><br></pre></td></tr></table></figure><h2 id="6Protocol-Using-StringTie-with-DESeq2"><a href="#6Protocol-Using-StringTie-with-DESeq2" class="headerlink" title="6Protocol:Using StringTie with DESeq2"></a>6Protocol:Using StringTie with DESeq2</h2><h3 id="Generate-count-matrices-using-prepDE-py"><a href="#Generate-count-matrices-using-prepDE-py" class="headerlink" title="Generate count matrices using prepDE.py"></a>Generate count matrices using prepDE.py</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(base) goubo@nucleusa:~/rna-seq_wyh$ python2.7 prepDE.py.txt &amp;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;RNA-seq-WYH&quot;&gt;&lt;a href=&quot;#RNA-seq-WYH&quot; class=&quot;headerlink&quot; title=&quot;RNA_seq_WYH&quot;&gt;&lt;/a&gt;RNA_seq_WYH&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;2019-10-13&lt;/p&gt;
&lt;p&gt;gou
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>北方有佳人</title>
    <link href="http://yoursite.com/2019/10/29/%E5%8C%97%E6%96%B9%E6%9C%89%E4%BD%B3%E4%BA%BA/"/>
    <id>http://yoursite.com/2019/10/29/北方有佳人/</id>
    <published>2019-10-29T03:30:57.618Z</published>
    <updated>2019-10-29T03:34:29.983Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to my blog ! This is my  first post. </p><h2 id="我爱凡凡小同学"><a href="#我爱凡凡小同学" class="headerlink" title="我爱凡凡小同学"></a>我爱凡凡小同学</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to my blog ! This is my  first post. &lt;/p&gt;
&lt;h2 id=&quot;我爱凡凡小同学&quot;&gt;&lt;a href=&quot;#我爱凡凡小同学&quot; class=&quot;headerlink&quot; title=&quot;我爱凡凡小同学&quot;&gt;&lt;/a&gt;我爱凡凡小同学&lt;/h2&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2019/10/29/hello-world/"/>
    <id>http://yoursite.com/2019/10/29/hello-world/</id>
    <published>2019-10-29T01:21:41.192Z</published>
    <updated>2019-10-29T01:21:41.192Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
